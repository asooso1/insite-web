# ì¸í”„ë¼ ê²°ì • ë¬¸ì„œ

> ì‘ì„±ì¼: 2026-02-06
> ìƒíƒœ: ğŸ”„ ì§„í–‰ì¤‘ (ê²°ì • ëŒ€ê¸°)

## ëª©ì 

insite-web ë°°í¬ í™˜ê²½ ë° ì¸í”„ë¼ êµ¬ì„±ì„ ê²°ì •í•©ë‹ˆë‹¤.

---

## 1. ë°°í¬ í”Œë«í¼ ì„ íƒ

### 1.1 í›„ë³´ í”Œë«í¼

| í”Œë«í¼ | ì¥ì  | ë‹¨ì  | ë¹„ìš© |
|--------|------|------|------|
| **Vercel** | Next.js ìµœì í™”, ê°„í¸í•œ ì„¤ì •, Edge Functions | ë°ì´í„° ì£¼ê¶Œ ì´ìŠˆ (ë¯¸êµ­ ì„œë²„), ê°€ê²© ìƒìŠ¹ ê°€ëŠ¥ | Pro: $20/ì›”~ |
| **AWS Amplify** | AWS ìƒíƒœê³„ í†µí•©, ap-northeast-2 ì§€ì› | ì„¤ì • ë³µì¡, Next.js ì§€ì› ì œí•œì  | ì‚¬ìš©ëŸ‰ ê¸°ë°˜ |
| **AWS ECS** | ì™„ì „í•œ ì œì–´, Fargateë¡œ ì„œë²„ë¦¬ìŠ¤ | ì´ˆê¸° ì„¤ì • ë³µì¡, ìš´ì˜ ë¶€ë‹´ | ì‚¬ìš©ëŸ‰ ê¸°ë°˜ |
| **AWS App Runner** | ECSë³´ë‹¤ ê°„ë‹¨, ì»¨í…Œì´ë„ˆ ê¸°ë°˜ | Next.js ISR ì œí•œì  | ì‚¬ìš©ëŸ‰ ê¸°ë°˜ |

### 1.2 í‰ê°€ ê¸°ì¤€

| ê¸°ì¤€ | ê°€ì¤‘ì¹˜ | Vercel | AWS Amplify | AWS ECS |
|------|--------|--------|-------------|---------|
| Next.js í˜¸í™˜ì„± | 30% | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| ë°ì´í„° ì£¼ê¶Œ (í•œêµ­) | 25% | â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| ì„¤ì • ìš©ì´ì„± | 20% | â­â­â­â­â­ | â­â­â­ | â­â­ |
| ë¹„ìš© ì˜ˆì¸¡ì„± | 15% | â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| ê¸°ì¡´ ì¸í”„ë¼ ì—°ë™ | 10% | â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |

### 1.3 í˜„ì¬ ì¸í”„ë¼ í˜„í™©

> csp-was/csp-web ê¸°ì¡´ ì¸í”„ë¼ í™•ì¸ í•„ìš”

- **ë¦¬ì „:** ap-northeast-2 (ì„œìš¸)
- **ë°ì´í„°ë² ì´ìŠ¤:** PostgreSQL (RDS ì¶”ì •)
- **ìºì‹œ:** Redis (ElastiCache ì¶”ì •)
- **ìŠ¤í† ë¦¬ì§€:** S3
- **ë©”ì‹œì§€ í:** RabbitMQ
- **ê²€ìƒ‰:** OpenSearch

### 1.4 ê²°ì • ì‚¬í•­

| í•­ëª© | ê²°ì • | ê·¼ê±° | ìƒíƒœ |
|------|------|------|------|
| ë°°í¬ í”Œë«í¼ | â³ ë¯¸ì • | ë°ì´í„° ì£¼ê¶Œ vs ê°œë°œ í¸ì˜ì„± ê²€í†  í•„ìš” | ê²°ì • ëŒ€ê¸° |
| ë¦¬ì „ | ap-northeast-2 | ê¸°ì¡´ ì¸í”„ë¼ì™€ ë™ì¼, ì§€ì—°ì‹œê°„ ìµœì†Œí™” | í™•ì • |

---

## 2. csp-was CORS ì„¤ì •

### 2.1 í˜„ì¬ CORS ì„¤ì • í™•ì¸

> csp-was SecurityConfig.java ë˜ëŠ” WebMvcConfig.java í™•ì¸ í•„ìš”

```java
// ì˜ˆìƒ ìœ„ì¹˜: csp-was/src/main/java/.../config/SecurityConfig.java
@Bean
public CorsConfigurationSource corsConfigurationSource() {
    CorsConfiguration configuration = new CorsConfiguration();
    configuration.setAllowedOrigins(Arrays.asList(
        "https://csp-web.hdclabs.com",  // ê¸°ì¡´
        "https://insite.hdclabs.com"    // ì¶”ê°€ í•„ìš”
    ));
    // ...
}
```

### 2.2 í•„ìš”í•œ ë³€ê²½

| í•­ëª© | í˜„ì¬ | ë³€ê²½ |
|------|------|------|
| Allowed Origins | csp-web ë„ë©”ì¸ë§Œ | + insite-web ë„ë©”ì¸ ì¶”ê°€ |
| ë³€ê²½ ë²”ìœ„ | - | 1ì¤„ ì¶”ê°€ |

### 2.3 ì ìš© ê³„íš

1. csp-was CORS ì„¤ì • íŒŒì¼ ìœ„ì¹˜ í™•ì¸
2. insite-web ë„ë©”ì¸ ê²°ì •
3. CORS í—ˆìš© ëª©ë¡ì— ë„ë©”ì¸ ì¶”ê°€
4. ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
5. í”„ë¡œë•ì…˜ ì ìš©

---

## 3. CI/CD íŒŒì´í”„ë¼ì¸ ì„¤ê³„

### 3.1 GitHub Actions ì›Œí¬í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PR ìƒì„±    â”‚ â”€â”€â†’ â”‚    CI       â”‚ â”€â”€â†’ â”‚  Preview    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ - lint      â”‚     â”‚  Environment â”‚
                    â”‚ - type-checkâ”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ - test      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  develop    â”‚ â”€â”€â†’ â”‚    CI       â”‚ â”€â”€â†’ â”‚  Staging    â”‚
â”‚  merge      â”‚     â”‚ + build     â”‚     â”‚  Deploy     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   main      â”‚ â”€â”€â†’ â”‚    CI       â”‚ â”€â”€â†’ â”‚ Production  â”‚
â”‚  merge      â”‚     â”‚ + build     â”‚     â”‚  Deploy     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ + e2e       â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 OpenAPI ìŠ¤í™ ìë™ ê°±ì‹ 

```yaml
# .github/workflows/sync-openapi.yml
name: Sync OpenAPI Spec

on:
  schedule:
    - cron: '0 0 * * *'  # ë§¤ì¼ ìì •
  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Download OpenAPI spec
        run: |
          curl -o openapi/spec.json \
            ${{ secrets.CSP_WAS_URL }}/v3/api-docs/v1-definition

      - name: Generate types
        run: npm run api:generate

      - name: Create PR if changed
        uses: peter-evans/create-pull-request@v5
        with:
          title: 'chore: OpenAPI ìŠ¤í™ ìë™ ê°±ì‹ '
          branch: auto/openapi-sync
```

### 3.3 í’ˆì§ˆ ê²Œì´íŠ¸

| ê²Œì´íŠ¸ | ì¡°ê±´ | ì°¨ë‹¨ ë ˆë²¨ |
|--------|------|----------|
| TypeScript | ì—ëŸ¬ 0ê°œ | PR ë³‘í•© ì°¨ë‹¨ |
| ESLint | ì—ëŸ¬ 0ê°œ | PR ë³‘í•© ì°¨ë‹¨ |
| ì ‘ê·¼ì„± Lint | ì—ëŸ¬ 0ê°œ | PR ë³‘í•© ì°¨ë‹¨ |
| í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ | 80% ì´ìƒ | ê²½ê³  |
| E2E í…ŒìŠ¤íŠ¸ | 100% í†µê³¼ | main ë°°í¬ ì°¨ë‹¨ |
| Lighthouse ì„±ëŠ¥ | 90ì  ì´ìƒ | ê²½ê³  |

---

## 4. ë„ë©”ì¸ ë° í™˜ê²½

### 4.1 ë„ë©”ì¸ í›„ë³´

| í™˜ê²½ | ë„ë©”ì¸ (ì˜ˆì‹œ) | ìƒíƒœ |
|------|--------------|------|
| Production | insite.hdclabs.com | ë¯¸ì • |
| Staging | staging-insite.hdclabs.com | ë¯¸ì • |
| Preview | pr-{number}-insite.hdclabs.com | ìë™ |

### 4.2 í™˜ê²½ ë³€ìˆ˜

| í™˜ê²½ | íŒŒì¼ | NEXT_PUBLIC_API_URL |
|------|------|---------------------|
| Local | .env.local | http://localhost:8080 |
| Development | .env.development | https://dev-api.hdclabs.com |
| Staging | .env.staging | https://staging-api.hdclabs.com |
| Production | .env.production | https://api.hdclabs.com |

---

## 5. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 5.1 í™˜ê²½ ë³€ìˆ˜ ë³´í˜¸

- ëª¨ë“  ì‹œí¬ë¦¿ì€ GitHub Secrets ë˜ëŠ” ë°°í¬ í”Œë«í¼ í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬
- `.env.local`ì€ .gitignoreì— í¬í•¨
- `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ê°€ ì—†ëŠ” ë³€ìˆ˜ëŠ” ì„œë²„ ì „ìš©

### 5.2 ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ

- csp-wasëŠ” VPC ë‚´ë¶€ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥ (ì¶”ì •)
- Next.js API Routesë¥¼ í†µí•œ í”„ë¡ì‹œ ì‹œ ë‚´ë¶€ URL ì‚¬ìš©
- ë¸Œë¼ìš°ì € ì§ì ‘ í˜¸ì¶œ ì‹œ ì™¸ë¶€ URL + CORS

---

## 6. ê²°ì • í•„ìš” í•­ëª©

| í•­ëª© | ë‹´ë‹¹ | ê¸°í•œ | ìƒíƒœ |
|------|------|------|------|
| ë°°í¬ í”Œë«í¼ ìµœì¢… ê²°ì • | ì¸í”„ë¼íŒ€ | Phase 1 ì „ | â³ |
| ë„ë©”ì¸ ê²°ì • | ì¸í”„ë¼íŒ€ | Phase 1 ì „ | â³ |
| csp-was CORS ë³€ê²½ ìŠ¹ì¸ | ë°±ì—”ë“œíŒ€ | Phase 1 ì „ | â³ |
| PostgreSQL ì ‘ì† ì •ë³´ ê³µìœ  | DBA | Phase 0 ì¤‘ | â³ |

---

## ì°¸ê³ 

- csp-was ìœ„ì¹˜: `/Volumes/jinseok-SSD-1tb/00_insite/csp-was/`
- AWS ë¦¬ì „: ap-northeast-2 (ì„œìš¸)
